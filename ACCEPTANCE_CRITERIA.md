# ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏—ë–º–∫–∏ - ClubSuite MVP

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤

### 1. ‚úÖ –ì–æ—Å—Ç—å –º–æ–∂–µ—Ç –æ–ø–ª–∞—Ç–∏—Ç—å –¥–µ–ø–æ–∑–∏—Ç –∏ –ø—Ä–æ–π—Ç–∏ check-in

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- `/reservations` - —Å–æ–∑–¥–∞–Ω–∏–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- `/payments/telegram/invoice` - —Å–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–≤–æ–π—Å–∞
- `/payments/telegram/callback` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ–ø–ª–∞—Ç—ã
- `/checkin/scan` - —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ QR –∏ check-in

**Flow:**
```
1. Guest –≤—ã–±–∏—Ä–∞–µ—Ç —Å–æ–±—ã—Ç–∏–µ –≤ WebApp
2. –°–æ–∑–¥–∞–µ—Ç –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ POST /reservations
3. –ü–æ–ª—É—á–∞–µ—Ç invoice —á–µ—Ä–µ–∑ POST /payments/telegram/invoice
4. –û–ø–ª–∞—á–∏–≤–∞–µ—Ç —á–µ—Ä–µ–∑ Telegram Payments
5. Webhook –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç —á–µ—Ä–µ–∑ POST /payments/telegram/callback
6. Reservation —Å—Ç–∞—Ç—É—Å –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ CONFIRMED
7. –ü—Ä–∏ check-in —Å–∫–∞–Ω–∏—Ä—É–µ—Ç—Å—è QR ‚Üí POST /checkin/scan
```

**–¢–µ—Å—Ç—ã:** ‚úÖ `reservation-flow.e2e-spec.ts`

---

### 2. ‚úÖ –ü—Ä–æ–º–æ—É—Ç–µ—Ä –≤–∏–¥–∏—Ç KPI –∏ –≥–æ—Å—Ç–µ–π

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- `/promoters/me/kpi` - –ø–æ–ª—É—á–µ–Ω–∏–µ KPI
- `/promoters/leads` - —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞—è–≤–æ–∫ –≥–æ—Å—Ç–µ–π
- Dashboard –≤ WebApp —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏

**KPI –≤–∫–ª—é—á–∞–µ—Ç:**
- totalReservations
- confirmedReservations
- conversionRate
- totalCommission
- paidCommission
- pendingCommission

**–¢–µ—Å—Ç—ã:** ‚úÖ `promoter-flow.e2e-spec.ts`

---

### 3. ‚úÖ Door-—Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç–∞–µ—Ç

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- `/checkin/scan` - —Å–∫–∞–Ω–µ—Ä QR-–∫–æ–¥–æ–≤
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ QR
- –ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏/—Ç–µ–ª–µ—Ñ–æ–Ω—É
- –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ü–æ–¥–ø–∏—Å—å QR —á–µ—Ä–µ–∑ HMAC-SHA256
- –ü—Ä–æ–≤–µ—Ä–∫–∞ expiry (24 —á–∞—Å–∞)
- –û—Ñ—Ñ–ª–∞–π–Ω-–∫—ç—à –≥–æ—Ç–æ–≤ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ IndexedDB

**–¢–µ—Å—Ç—ã:** ‚úÖ Unit tests –¥–ª—è QR validation

---

### 4. ‚úÖ Admin –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –∏ –ø–∞–∫–µ—Ç—ã

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- UI –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏—è–º–∏
- UI –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–∫–µ—Ç–∞–º–∏
- `/reports/overview` - –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
- GraphQL/REST API –≥–æ—Ç–æ–≤ –∫ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é

**–§—É–Ω–∫—Ü–∏–∏:**
- –°–æ–∑–¥–∞–Ω–∏–µ/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π
- –°–æ–∑–¥–∞–Ω–∏–µ/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞–∫–µ—Ç–æ–≤
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, —Å–æ–±—ã—Ç–∏—è, –≤—ã—Ä—É—á–∫–∞)
- –ú–µ—Ç—Ä–∏–∫–∏ (–∫–æ–Ω–≤–µ—Ä—Å–∏—è, —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫)

---

### 5. ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å Mini App —Å–æ–±–ª—é–¥–µ–Ω–∞

**–í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–¥–ø–∏—Å–∏:**
- ‚úÖ HMAC-SHA256 –∞–ª–≥–æ—Ä–∏—Ç–º Telegram
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ data_check_string
- ‚úÖ –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –∏–∑ BOT_TOKEN
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è hash

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** `apps/api/src/utils/telegram-validator.util.ts`

```typescript
// –ê–ª–≥–æ—Ä–∏—Ç–º –≤–∞–ª–∏–¥–∞—Ü–∏–∏:
1. –ò–∑–≤–ª–µ—á—å hash –∏–∑ initData
2. –°–æ–∑–¥–∞—Ç—å data check string (–æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å params)
3. –°–æ–∑–¥–∞—Ç—å secret key: HMAC-SHA256("WebAppData", BOT_TOKEN)
4. –í—ã—á–∏—Å–ª–∏—Ç—å hash: HMAC-SHA256(secretKey, dataCheckString)
5. –°—Ä–∞–≤–Ω–∏—Ç—å —Å hash –∏–∑ initData
```

**–ó–∞—â–∏—Ç–∞:**
- ‚úÖ –ù–µ–ª—å–∑—è –ø–æ–¥–¥–µ–ª–∞—Ç—å initData
- ‚úÖ –ù–µ–ª—å–∑—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ
- ‚úÖ –°–µ—Ä–≤–µ—Ä–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞

**–¢–µ—Å—Ç—ã:** ‚úÖ `telegram-validator.util.spec.ts`

---

## üìã –ò—Ç–æ–≥–æ–≤—ã–π checklist

### –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- ‚úÖ docker-compose.yml (PostgreSQL + Redis)
- ‚úÖ pnpm workspace
- ‚úÖ All scripts (dev, test, lint, db:migrate, db:seed)
- ‚úÖ .env.example —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- ‚úÖ Telegram initData validation (HMAC-SHA256)
- ‚úÖ JWT —Å —Ä–æ–ª—è–º–∏ (Guest, Promoter, Door, Manager, Admin)
- ‚úÖ Rate limiting (Redis)
- ‚úÖ PII –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –ª–æ–≥–∞—Ö
- ‚úÖ Input validation (Zod + class-validator)

### –¢–µ—Å—Ç—ã
- ‚úÖ Unit —Ç–µ—Å—Ç—ã –¥–ª—è auth
- ‚úÖ Unit —Ç–µ—Å—Ç—ã –¥–ª—è QR
- ‚úÖ E2E —Ç–µ—Å—Ç—ã –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞
- ‚úÖ E2E —Ç–µ—Å—Ç—ã –¥–ª—è waitlist
- ‚úÖ E2E —Ç–µ—Å—Ç—ã –¥–ª—è promoter
- ‚úÖ –ü–æ–∫—Ä—ã—Ç–∏–µ ‚â•70%

### CI/CD
- ‚úÖ GitHub Actions workflow
- ‚úÖ Lint job
- ‚úÖ Typecheck job
- ‚úÖ Test job (—Å PostgreSQL –∏ Redis)
- ‚úÖ Build job

### QR Codes
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å –ø–æ–¥–ø–∏—Å—å—é
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–¥–ø–∏—Å–∏
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ expiry
- ‚úÖ –¢–µ—Å—Ç—ã

### Swagger
- ‚úÖ –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- ‚úÖ JWT –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –≤ Swagger
- ‚úÖ Try it out —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤/–æ—Ç–≤–µ—Ç–æ–≤

---

## üéØ –í—Å–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã!

‚úÖ –ì–æ—Å—Ç—å: –±—Ä–æ–Ω—å ‚Üí –æ–ø–ª–∞—Ç–∞ ‚Üí check-in  
‚úÖ –ü—Ä–æ–º–æ—É—Ç–µ—Ä: KPI –∏ –≥–æ—Å—Ç–∏  
‚úÖ Door: –æ—Ñ—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º (–≥–æ—Ç–æ–≤)  
‚úÖ Admin: –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–æ–±—ã—Ç–∏–π –∏ –ø–∞–∫–µ—Ç–æ–≤  
‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–¥–ø–∏—Å–∏  

**–ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É!** üöÄ
