# ClubSuite - ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ° Ğ¸ ĞŸĞ¾Ñ‚Ğ¾ĞºĞ¸ Ğ”Ğ°Ğ½Ğ½Ñ‹Ñ…

## ğŸ—ï¸ Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ½Ğ°Ñ ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         TELEGRAM                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚  Telegram    â”‚              â”‚  Telegram    â”‚                 â”‚
â”‚  â”‚     Bot      â”‚              â”‚   Mini App   â”‚                 â”‚
â”‚  â”‚ (ClubSuite)  â”‚              â”‚   (WebApp)   â”‚                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                              â”‚
          â”‚ Webhook                      â”‚ HTTPS API
          â”‚                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Bot Backend      â”‚          â”‚  Main Backend   â”‚
â”‚   (Node.js)        â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   (NestJS)      â”‚
â”‚   - Commands       â”‚  Internalâ”‚   - Business    â”‚
â”‚   - Payments       â”‚    API   â”‚     Logic       â”‚
â”‚   - Notifications  â”‚          â”‚   - Database    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
                                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
                                â”‚   PostgreSQL    â”‚
                                â”‚   + Redis       â”‚
                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š ĞŸĞ¾Ñ‚Ğ¾ĞºĞ¸ Ğ”Ğ°Ğ½Ğ½Ñ‹Ñ… ĞŸĞ¾ Ğ Ğ¾Ğ»ÑĞ¼

### 1ï¸âƒ£ Ğ“ĞĞ¡Ğ¢Ğ¬ - ĞŸĞ¾ĞºÑƒĞ¿ĞºĞ° Ğ‘Ğ¸Ğ»ĞµÑ‚Ğ°

```
[Ğ“Ğ¾ÑÑ‚ÑŒ] 
   â†“ ĞšĞ»Ğ¸ĞºĞ°ĞµÑ‚ ÑÑÑ‹Ğ»ĞºÑƒ Ğ¾Ñ‚ Ğ¿Ñ€Ğ¾Ğ¼Ğ¾ÑƒÑ‚ĞµÑ€Ğ°
[Telegram Bot]
   â†“ /start promoter_XXX â†’ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑĞµÑ‚ Ğ°Ñ‚Ñ€Ğ¸Ğ±ÑƒÑ†Ğ¸Ñ
[Mini App Opens]
   â†“ Ğ’Ñ‹Ğ±Ğ¸Ñ€Ğ°ĞµÑ‚ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğµ â†’ "Buy Ticket"
[Telegram Bot]
   â†“ ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ Invoice Ñ‡ĞµÑ€ĞµĞ· Telegram Payments
[Telegram Payment Form]
   â†“ Ğ“Ğ¾ÑÑ‚ÑŒ Ğ²Ğ²Ğ¾Ğ´Ğ¸Ñ‚ ĞºĞ°Ñ€Ñ‚Ñƒ Ğ¸ Ğ¿Ğ»Ğ°Ñ‚Ğ¸Ñ‚
[Telegram Bot]
   â†“ ĞŸĞ¾Ğ»ÑƒÑ‡Ğ°ĞµÑ‚ successful_payment
[Backend API]
   â†“ Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµÑ‚ Ticket Ñ QR-ĞºĞ¾Ğ´Ğ¾Ğ¼
[Telegram Bot]
   â†“ ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ QR-Ğ±Ğ¸Ğ»ĞµÑ‚ Ğ³Ğ¾ÑÑ‚Ñ
[Ğ“Ğ¾ÑÑ‚ÑŒ]
   âœ… Ğ˜Ğ¼ĞµĞµÑ‚ Ğ±Ğ¸Ğ»ĞµÑ‚, Ğ³Ğ¾Ñ‚Ğ¾Ğ² Ğº Ğ²Ñ…Ğ¾Ğ´Ñƒ
```

**Ğ’Ñ€ĞµĞ¼Ñ**: 30-60 ÑĞµĞºÑƒĞ½Ğ´ Ğ¾Ñ‚ Ğ¿Ñ€Ğ¸Ğ³Ğ»Ğ°ÑˆĞµĞ½Ğ¸Ñ Ğ´Ğ¾ QR-ĞºĞ¾Ğ´Ğ°

---

### 2ï¸âƒ£ ĞŸĞ ĞĞœĞĞ£Ğ¢Ğ•Ğ  - ĞŸÑ€Ğ¸Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğµ Ğ“Ğ¾ÑÑ‚ĞµĞ¹

```
[ĞŸÑ€Ğ¾Ğ¼Ğ¾ÑƒÑ‚ĞµÑ€]
   â†“ /promoter â†’ "Generate Link"
[Bot Backend]
   â†“ Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµÑ‚ ÑƒĞ½Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ ĞºĞ¾Ğ´
[Main Backend]
   â†“ Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµÑ‚ promoter_code Ğ² Redis (TTL 24h)
[Bot]
   â†“ ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ deep-link Ğ¿Ñ€Ğ¾Ğ¼Ğ¾ÑƒÑ‚ĞµÑ€Ñƒ
[ĞŸÑ€Ğ¾Ğ¼Ğ¾ÑƒÑ‚ĞµÑ€]
   â†“ Ğ”ĞµĞ»Ğ¸Ñ‚ÑÑ ÑÑÑ‹Ğ»ĞºĞ¾Ğ¹ Ğ² ÑĞ¾Ñ†ÑĞµÑ‚ÑÑ…
[ĞĞ¾Ğ²Ñ‹Ğ¹ Ğ“Ğ¾ÑÑ‚ÑŒ]
   â†“ ĞšĞ»Ğ¸ĞºĞ°ĞµÑ‚ â†’ Ğ¾Ñ‚ĞºÑ€Ñ‹Ğ²Ğ°ĞµÑ‚ÑÑ Ğ±Ğ¾Ñ‚
[Bot]
   â†“ /start promoter_XXX
[Main Backend]
   â†“ Ğ¡Ğ²ÑĞ·Ñ‹Ğ²Ğ°ĞµÑ‚ Ğ³Ğ¾ÑÑ‚Ñ Ñ Ğ¿Ñ€Ğ¾Ğ¼Ğ¾ÑƒÑ‚ĞµÑ€Ğ¾Ğ¼
[Ğ‘Ğ°Ğ·Ğ° Ğ”Ğ°Ğ½Ğ½Ñ‹Ñ…]
   âœ… ĞÑ‚Ñ€Ğ¸Ğ±ÑƒÑ†Ğ¸Ñ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ° Ğ½Ğ°Ğ²ÑĞµĞ³Ğ´Ğ°
```

**Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚**: Ğ’ÑĞµ Ğ¿Ğ¾ĞºÑƒĞ¿ĞºĞ¸ Ğ³Ğ¾ÑÑ‚Ñ Ğ¿Ñ€Ğ¸Ğ¿Ğ¸ÑÑ‹Ğ²Ğ°ÑÑ‚ÑÑ Ğ¿Ñ€Ğ¾Ğ¼Ğ¾ÑƒÑ‚ĞµÑ€Ñƒ

---

### 3ï¸âƒ£ DOOR - Ğ’Ñ…Ğ¾Ğ´ Ğ“Ğ¾ÑÑ‚Ñ

```
[Ğ“Ğ¾ÑÑ‚ÑŒ ĞŸÑ€Ğ¸Ñ…Ğ¾Ğ´Ğ¸Ñ‚]
   â†“ ĞŸĞ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ QR-ĞºĞ¾Ğ´ Ğ¸Ğ· Telegram
[Door Person]
   â†“ Ğ¡ĞºĞ°Ğ½Ğ¸Ñ€ÑƒĞµÑ‚ QR ĞºĞ°Ğ¼ĞµÑ€Ğ¾Ğ¹
[Mini App Scanner]
   â†“ ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ QR-ĞºĞ¾Ğ´ Ğ½Ğ° API
[Main Backend]
   â†“ ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµÑ‚ Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ½Ğ¾ÑÑ‚ÑŒ Ğ±Ğ¸Ğ»ĞµÑ‚Ğ°
   â†“ Ğ—Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ĞµÑ‚ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ³Ğ¾ÑÑ‚Ñ
[Mini App]
   â†“ ĞŸĞ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚:
     - Ğ˜Ğ¼Ñ Ğ³Ğ¾ÑÑ‚Ñ
     - Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ (VIP/Ğ¾Ğ±Ñ‹Ñ‡Ğ½Ñ‹Ğ¹)
     - Ğ¢Ğ¸Ğ¿ Ğ±Ğ¸Ğ»ĞµÑ‚Ğ°/Ğ±Ñ€Ğ¾Ğ½Ğ¸
     - Ğ˜Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¸
[Door Person]
   â†“ ĞĞ°Ğ¶Ğ¸Ğ¼Ğ°ĞµÑ‚ âœ… Admit
[Main Backend]
   â†“ ĞÑ‚Ğ¼ĞµÑ‡Ğ°ĞµÑ‚ check_in_time
   â†“ ĞĞ±Ğ½Ğ¾Ğ²Ğ»ÑĞµÑ‚ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºÑƒ
[Ğ“Ğ¾ÑÑ‚ÑŒ]
   âœ… ĞŸÑ€Ğ¾Ñ…Ğ¾Ğ´Ğ¸Ñ‚ Ğ²Ğ½ÑƒÑ‚Ñ€ÑŒ
```

**OFFLINE Ñ€ĞµĞ¶Ğ¸Ğ¼:**
```
[ĞĞµÑ‚ Ğ˜Ğ½Ñ‚ĞµÑ€Ğ½ĞµÑ‚Ğ°] ğŸ“¡
   â†“ Scanner Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ñ ĞºÑÑˆĞµĞ¼
[Local Storage]
   â†“ ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµÑ‚ QR Ğ»Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ğ¾
   â†“ Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµÑ‚ check-in Ğ² Ğ¾Ñ‡ĞµÑ€ĞµĞ´ÑŒ
[Ğ˜Ğ½Ñ‚ĞµÑ€Ğ½ĞµÑ‚ ĞŸĞ¾ÑĞ²Ğ¸Ğ»ÑÑ] ğŸŸ¢
   â†“ ĞĞ°Ğ¶Ğ¸Ğ¼Ğ°ĞµÑ‚ "Sync Queue"
[Main Backend]
   âœ… Ğ’ÑĞµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ ÑĞ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ñ‹
```

---

### 4ï¸âƒ£ ĞĞ”ĞœĞ˜ĞĞ˜Ğ¡Ğ¢Ğ ĞĞ¢ĞĞ  - Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¡Ğ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ

```
[Admin]
   â†“ Ğ›Ğ¾Ğ³Ğ¸Ğ½ â†’ admin/Q123456
[Admin Panel]
   â†“ "Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğµ"
[Form]
   â†“ Ğ—Ğ°Ğ¿Ğ¾Ğ»Ğ½ÑĞµÑ‚ Ğ²ÑĞµ Ğ¿Ğ¾Ğ»Ñ
[Submit]
   â†“ POST /catalog/admin/events
[Main Backend]
   â†“ Ğ’Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸Ñ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…
   â†“ Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Event Ğ² Ğ‘Ğ”
[Database]
   âœ… Ğ¡Ğ¾Ğ±Ñ‹Ñ‚Ğ¸Ğµ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¾
[Catalog API]
   â†“ GET /catalog/events
[Mini App]
   âœ… Ğ¡Ğ¾Ğ±Ñ‹Ñ‚Ğ¸Ğµ Ğ¿Ğ¾ÑĞ²Ğ¸Ğ»Ğ¾ÑÑŒ Ğ² ÑĞ¿Ğ¸ÑĞºĞµ
```

---

## ğŸ” Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ - ĞšÑ€Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ¢Ğ¾Ñ‡ĞºĞ¸

### ĞÑƒÑ‚ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ Mini App (ĞĞ‘Ğ¯Ğ—ĞĞ¢Ğ•Ğ›Ğ¬ĞĞ!)

```
[Mini App ĞÑ‚ĞºÑ€Ñ‹Ğ²Ğ°ĞµÑ‚ÑÑ]
   â†“ window.Telegram.WebApp.initData
[Frontend]
   â†“ ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ initData Ğ½Ğ° API
[Backend]
   â†“ ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµÑ‚ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑÑŒ Ñ BOT_TOKEN
   â†“ Ğ˜Ğ·Ğ²Ğ»ĞµĞºĞ°ĞµÑ‚ user_id, username
   â†“ Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµÑ‚ JWT ÑĞµÑÑĞ¸Ñ
[Frontend]
   âœ… Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ÑĞµÑ‚ JWT Ğ´Ğ»Ñ Ğ¿Ğ¾ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ñ… Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²
```

**ĞŸĞ¾Ñ‡ĞµĞ¼Ñƒ Ğ’Ğ°Ğ¶Ğ½Ğ¾:**
- initData Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞ°Ğ½ Telegram â†’ Ğ½ĞµĞ»ÑŒĞ·Ñ Ğ¿Ğ¾Ğ´Ğ´ĞµĞ»Ğ°Ñ‚ÑŒ
- Ğ‘ĞµĞ· Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸ Ğ¿Ğ¾Ğ´Ğ¿Ğ¸ÑĞ¸ = Ğ»ÑĞ±Ğ¾Ğ¹ Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ¿Ñ€Ğ¸Ñ‚Ğ²Ğ¾Ñ€Ğ¸Ñ‚ÑŒÑÑ Ğ»ÑĞ±Ñ‹Ğ¼ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¼
- **ĞĞ• Ğ”ĞĞ’Ğ•Ğ Ğ¯Ğ¢Ğ¬** initDataUnsafe (Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ´Ğ»Ñ Ğ¾Ñ‚Ğ»Ğ°Ğ´ĞºĞ¸!)

### Deep Links - Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ¾ÑÑ‚ÑŒ ĞÑ‚Ñ€Ğ¸Ğ±ÑƒÑ†Ğ¸Ğ¸

```
[Promoter Link Generated]
   â†“ Ğ£Ğ½Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ñ‚Ğ¾ĞºĞµĞ½ = UUID
[Redis]
   â†“ Ğ¡Ğ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ğµ: token â†’ promoter_id (TTL 24h)
[Ğ“Ğ¾ÑÑ‚ÑŒ ĞšĞ»Ğ¸ĞºĞ°ĞµÑ‚]
   â†“ /start promoter_TOKEN
[Backend]
   â†“ ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµÑ‚ Ñ‚Ğ¾ĞºĞµĞ½ Ğ² Redis
   â†“ Ğ•ÑĞ»Ğ¸ Ğ²Ğ°Ğ»Ğ¸Ğ´ĞµĞ½ â†’ ÑĞ²ÑĞ·Ñ‹Ğ²Ğ°ĞµÑ‚ Ğ³Ğ¾ÑÑ‚Ñ Ñ Ğ¿Ñ€Ğ¾Ğ¼Ğ¾ÑƒÑ‚ĞµÑ€Ğ¾Ğ¼
   â†“ Ğ£Ğ´Ğ°Ğ»ÑĞµÑ‚ Ñ‚Ğ¾ĞºĞµĞ½ (Ğ¾Ğ´Ğ½Ğ¾Ñ€Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹!)
[Database]
   âœ… Guest.referredBy = Promoter.id
```

**Ğ—Ğ°Ñ‰Ğ¸Ñ‚Ğ° Ğ¾Ñ‚ Ğ¤Ñ€Ğ¾Ğ´Ğ°:**
- Ğ¢Ğ¾ĞºĞµĞ½ Ğ¾Ğ´Ğ½Ğ¾Ñ€Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹
- TTL 24 Ñ‡Ğ°ÑĞ°
- ĞŸĞµÑ€Ğ²Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾Ğ¼Ğ¾ÑƒÑ‚ĞµÑ€ "Ğ·Ğ°Ñ…Ğ²Ğ°Ñ‚Ñ‹Ğ²Ğ°ĞµÑ‚" Ğ³Ğ¾ÑÑ‚Ñ Ğ½Ğ°Ğ²ÑĞµĞ³Ğ´Ğ°

---

## ğŸ’³ ĞŸĞ»Ğ°Ñ‚ĞµĞ¶Ğ¸ - Telegram Payments Flow

```
[Mini App]
   â†“ Ğ“Ğ¾ÑÑ‚ÑŒ Ğ½Ğ°Ğ¶Ğ¸Ğ¼Ğ°ĞµÑ‚ "Buy Ticket"
[Telegram Bot]
   â†“ ctx.api.sendInvoice(...)
   â†“ ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹:
     - title: "ClubSuite - Event Ticket"
     - description: ĞĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ
     - payload: ticket_EVENT_ID_TIMESTAMP
     - provider_token: PAYMENT_PROVIDER_TOKEN
     - prices: [{ label: 'Ticket', amount: 2500 }]
[Telegram]
   â†“ ĞŸĞ¾ĞºĞ°Ğ·Ñ‹Ğ²Ğ°ĞµÑ‚ Ñ„Ğ¾Ñ€Ğ¼Ñƒ Ğ¾Ğ¿Ğ»Ğ°Ñ‚Ñ‹ Ğ³Ğ¾ÑÑ‚Ñ
[Ğ“Ğ¾ÑÑ‚ÑŒ]
   â†“ Ğ’Ğ²Ğ¾Ğ´Ğ¸Ñ‚ ĞºĞ°Ñ€Ñ‚Ñƒ â†’ ĞĞ¿Ğ»Ğ°Ñ‡Ğ¸Ğ²Ğ°ĞµÑ‚
[Telegram]
   â†“ pre_checkout_query â†’ Ğ±Ğ¾Ñ‚ Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½ Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ¸Ñ‚ÑŒ OK
[Bot Backend]
   â†“ ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµÑ‚ payload
   â†“ ctx.answerPreCheckoutQuery(true)
[Telegram]
   â†“ Ğ¡Ğ¿Ğ¸ÑÑ‹Ğ²Ğ°ĞµÑ‚ Ğ´ĞµĞ½ÑŒĞ³Ğ¸
   â†“ successful_payment â†’ Ğ±Ğ¾Ñ‚ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ°ĞµÑ‚ ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ğµ
[Bot Backend]
   â†“ Ğ˜Ğ·Ğ²Ğ»ĞµĞºĞ°ĞµÑ‚ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶Ğ°
   â†“ POST /payments/telegram/callback
[Main Backend]
   â†“ Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµÑ‚ Ticket
   â†“ Ğ“ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµÑ‚ QR-ĞºĞ¾Ğ´
   â†“ Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ ticket_id
[Bot]
   â†“ ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ QR Ğ³Ğ¾ÑÑ‚Ñ
[Ğ“Ğ¾ÑÑ‚ÑŒ]
   âœ… ĞŸĞ¾Ğ»ÑƒÑ‡Ğ¸Ğ» Ğ±Ğ¸Ğ»ĞµÑ‚!
```

**Ğ’Ğ°Ğ¶Ğ½Ğ¾:**
- `amount` Ğ² ĞºĞ¾Ğ¿ĞµĞ¹ĞºĞ°Ñ… (25.00$ = 2500)
- `payload` = ÑƒĞ½Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¸Ğ´ĞµĞ½Ñ‚Ğ¸Ñ„Ğ¸ĞºĞ°Ñ‚Ğ¾Ñ€ Ğ´Ğ»Ñ ÑĞ²ÑĞ·Ğ¸ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶Ğ° Ñ Ğ±Ğ¸Ğ»ĞµÑ‚Ğ¾Ğ¼
- `provider_token` = Ñ‚Ğ¾ĞºĞµĞ½ Ğ¾Ñ‚ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶Ğ½Ğ¾Ğ³Ğ¾ Ğ¿Ñ€Ğ¾Ğ²Ğ°Ğ¹Ğ´ĞµÑ€Ğ° (Stripe/Ğ®Money)

---

## ğŸ¯ ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹ Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ñ‹ - Ğ”ĞµÑ‚Ğ°Ğ»Ğ¸

### Backend API (NestJS)

**ĞœĞ¾Ğ´ÑƒĞ»Ğ¸:**
```
AppModule
â”œâ”€â”€ AuthModule (JWT, Telegram validation)
â”œâ”€â”€ CatalogModule (Events, Packages, Venues)
â”œâ”€â”€ ReservationsModule (Table bookings)
â”œâ”€â”€ TicketsModule (Ticket purchase, QR)
â”œâ”€â”€ PaymentsModule (Telegram Payments callback)
â”œâ”€â”€ CheckinModule (Door QR scan)
â”œâ”€â”€ PromotersModule (Links, KPI, Guests)
â”œâ”€â”€ ReportsModule (Analytics)
â””â”€â”€ UsersModule (User management)
```

**Ğ‘Ğ°Ğ·Ğ° Ğ”Ğ°Ğ½Ğ½Ñ‹Ñ… (Prisma Schema):**
```
User (id, telegramId, role, vipLevel, referredBy)
  â†“ 1:N
Ticket (id, userId, eventId, qrCode, status)
Reservation (id, userId, eventId, tableId, deposit)
  â†“ N:1
Event (id, venueId, date, name, capacity)
  â†“ N:1
Venue (id, name, city, address)
  â†“ 1:N
Hall (id, venueId, name, capacity)
  â†“ 1:N
Package (id, eventId, name, price, benefits)
```

### Bot Backend (Grammy.js)

**Handlers:**
```
commands.ts
  - /start (deep links, promoter attribution)
  - /menu, /events, /my, /help
  
promoter.ts
  - /promoter (dashboard)
  - Generate links
  - View guests
  - KPI stats
  - Broadcast
  
payments.ts
  - pre_checkout_query (validate before payment)
  - successful_payment (create ticket)
  
callbacks.ts
  - Button handlers
  - Navigation
```

### Frontend (Next.js 14)

**Pages:**
```
/events              - ĞšĞ°Ñ‚Ğ°Ğ»Ğ¾Ğ³ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹
/events/[id]         - Ğ”ĞµÑ‚Ğ°Ğ»Ğ¸ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ + Ğ¿Ğ¾ĞºÑƒĞ¿ĞºĞ°
/book                - Ğ‘Ñ€Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ ÑÑ‚Ğ¾Ğ»Ğ° (Ñ„Ğ¾Ñ€Ğ¼Ğ°)
/my/tickets          - QR-Ğ±Ğ¸Ğ»ĞµÑ‚Ñ‹ Ğ³Ğ¾ÑÑ‚Ñ
/promoter            - Dashboard Ğ¿Ñ€Ğ¾Ğ¼Ğ¾ÑƒÑ‚ĞµÑ€Ğ°
/door                - Ğ¡ĞºĞ°Ğ½ĞµÑ€ QR Ğ´Ğ»Ñ Ğ²Ñ…Ğ¾Ğ´Ğ°
/waitlist            - Ğ—Ğ°Ğ¿Ğ¸ÑÑŒ Ğ² Ğ»Ğ¸ÑÑ‚ Ğ¾Ğ¶Ğ¸Ğ´Ğ°Ğ½Ğ¸Ñ
/admin               - ĞŸĞ°Ğ½ĞµĞ»ÑŒ Ğ°Ğ´Ğ¼Ğ¸Ğ½Ğ¸ÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€Ğ°
/admin/events/create - Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ
/admin/packages/new  - Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¿Ğ°ĞºĞµÑ‚Ğ°
/admin/users         - Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑĞ¼Ğ¸
```

---

## ğŸ”„ ĞšÑ€Ğ¸Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ ĞŸÑ€Ğ¾Ñ†ĞµÑÑÑ‹ - Ğ”ĞµÑ‚Ğ°Ğ»Ğ¸

### Waitlist - ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ğ£Ğ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ

```
[Ğ¡Ğ¾Ğ±Ñ‹Ñ‚Ğ¸Ğµ Ğ—Ğ°Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¾]
   â†“ capacity = 200, sold = 200
[Ğ“Ğ¾ÑÑ‚ÑŒ]
   â†“ ĞĞ°Ğ¶Ğ¸Ğ¼Ğ°ĞµÑ‚ "Join Waitlist"
[Backend]
   â†“ Ğ¡Ğ¾Ğ·Ğ´Ğ°ĞµÑ‚ WaitlistEntry
   â†“ position = 1, 2, 3...
[Ğ”Ñ€ÑƒĞ³Ğ¾Ğ¹ Ğ“Ğ¾ÑÑ‚ÑŒ ĞÑ‚Ğ¼ĞµĞ½ÑĞµÑ‚ Ğ‘Ñ€Ğ¾Ğ½ÑŒ]
   â†“ sold = 199, available = 1
[Backend - Cron Job ĞºĞ°Ğ¶Ğ´Ñ‹Ğµ 5 Ğ¼Ğ¸Ğ½]
   â†“ ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµÑ‚ waitlist
   â†“ ĞĞ°Ñ…Ğ¾Ğ´Ğ¸Ñ‚ Ğ¿ĞµÑ€Ğ²Ğ¾Ğ³Ğ¾ Ğ² Ğ¾Ñ‡ĞµÑ€ĞµĞ´Ğ¸
[Bot]
   â†“ ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ğµ:
     "ğŸ‰ ĞœĞµÑÑ‚Ğ¾ Ğ¾ÑĞ²Ğ¾Ğ±Ğ¾Ğ´Ğ¸Ğ»Ğ¾ÑÑŒ! 
      Ğ£ Ğ²Ğ°Ñ 15 Ğ¼Ğ¸Ğ½ÑƒÑ‚ Ğ´Ğ»Ñ Ğ±Ñ€Ğ¾Ğ½Ğ¸."
[Ğ“Ğ¾ÑÑ‚ÑŒ]
   â†“ ĞšĞ»Ğ¸ĞºĞ°ĞµÑ‚ â†’ Ğ¾Ğ¿Ğ»Ğ°Ñ‡Ğ¸Ğ²Ğ°ĞµÑ‚
[Backend]
   â†“ Ğ£Ğ´Ğ°Ğ»ÑĞµÑ‚ Ğ¸Ğ· waitlist
   â†“ sold = 200
```

**ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚ Ğ² waitlist:**
1. VIP Ğ³Ğ¾ÑÑ‚Ğ¸ (Ğ²Ñ‹ÑˆĞµ Ğ² Ğ¾Ñ‡ĞµÑ€ĞµĞ´Ğ¸)
2. Ğ’Ñ€ĞµĞ¼Ñ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ² waitlist
3. Ğ Ğ°Ğ·Ğ¼ĞµÑ€ Ğ³Ñ€ÑƒĞ¿Ğ¿Ñ‹ (Ğ¼ĞµĞ½ÑŒÑˆĞµ = Ğ²Ñ‹ÑˆĞµ ÑˆĞ°Ğ½Ñ)

### VIP CRM - ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ ĞĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ

```
[Ğ“Ğ¾ÑÑ‚ÑŒ ĞŸĞ¾ĞºÑƒĞ¿Ğ°ĞµÑ‚ Ğ‘Ğ¸Ğ»ĞµÑ‚]
   â†“
[Backend Ğ¡Ğ¼Ğ¾Ñ‚Ñ€Ğ¸Ñ‚ Ğ˜ÑÑ‚Ğ¾Ñ€Ğ¸Ñ]
   â†“ Ğ•ÑĞ»Ğ¸ spent_total > $500 â†’ VIP Silver
   â†“ Ğ•ÑĞ»Ğ¸ spent_total > $1000 â†’ VIP Gold
   â†“ Ğ•ÑĞ»Ğ¸ spent_total > $2500 â†’ VIP Platinum
[Database]
   â†“ User.vipLevel = 'GOLD'
   â†“ User.vipSince = now()
[Benefits Activated]
   âœ… ĞŸÑ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚ Ğ² waitlist
   âœ… Ğ Ğ°Ğ½Ğ½Ğ¸Ğ¹ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ Ğº Ğ½Ğ¾Ğ²Ñ‹Ğ¼ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸ÑĞ¼
   âœ… ĞŸĞµÑ€ÑĞ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¼ĞµĞ½ĞµĞ´Ğ¶ĞµÑ€
   âœ… ĞšĞ¾Ğ¼Ğ¿Ğ»Ğ¸Ğ¼ĞµĞ½Ñ‚Ñ‹ Ğ¾Ñ‚ Ğ·Ğ°Ğ²ĞµĞ´ĞµĞ½Ğ¸Ñ
```

**VIP Ğ±ĞµĞ¹Ğ´Ğ¶ Ğ½Ğ° Ğ²Ñ…Ğ¾Ğ´Ğµ:**
- Door person Ğ²Ğ¸Ğ´Ğ¸Ñ‚ â­ GOLD VIP
- ĞÑĞ¾Ğ±Ğ¾Ğµ Ğ²Ğ½Ğ¸Ğ¼Ğ°Ğ½Ğ¸Ğµ Ğ¸ ÑĞµÑ€Ğ²Ğ¸Ñ

### No-Show Handling

```
[Ğ¡Ğ¾Ğ±Ñ‹Ñ‚Ğ¸Ğµ Ğ—Ğ°Ğ²ĞµÑ€ÑˆĞ¸Ğ»Ğ¾ÑÑŒ]
   â†“ event.endTime Ğ¿Ñ€Ğ¾ÑˆĞ»Ğ¾
[Backend - Cron Job]
   â†“ ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµÑ‚ Ğ²ÑĞµ Reservations
   â†“ Ğ•ÑĞ»Ğ¸ check_in_time = null â†’ NO SHOW
[Penalty]
   â†“ Ğ•ÑĞ»Ğ¸ deposit Ğ¾Ğ¿Ğ»Ğ°Ñ‡ĞµĞ½ â†’ Ğ½Ğµ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ÑÑ
   â†“ User.noShowCount += 1
[Ğ•ÑĞ»Ğ¸ noShowCount >= 3]
   â†“ User.restricted = true
   â†“ Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğµ Ğ±Ñ€Ğ¾Ğ½Ğ¸ Ñ‚Ñ€ĞµĞ±ÑƒÑÑ‚ 100% Ğ¿Ñ€ĞµĞ´Ğ¾Ğ¿Ğ»Ğ°Ñ‚Ñƒ
[Bot Notification]
   â†“ "âŒ Ğ’Ñ‹ Ğ½Ğµ Ğ¿Ñ€Ğ¸ÑˆĞ»Ğ¸ Ğ½Ğ° ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğµ.
      Ğ”ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚ Ğ½Ğµ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ÑÑ."
```

---

## ğŸ”Œ API Endpoints - ĞŸĞ¾Ğ»Ğ½Ğ°Ñ ĞšĞ°Ñ€Ñ‚Ğ°

### Public (Ğ‘ĞµĞ· Auth)
```
GET  /catalog/events           - Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğ¹
GET  /catalog/events/:id       - Ğ”ĞµÑ‚Ğ°Ğ»Ğ¸ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ
GET  /catalog/packages         - VIP Ğ¿Ğ°ĞºĞµÑ‚Ñ‹
POST /auth/browser-login       - Ğ›Ğ¾Ğ³Ğ¸Ğ½ Ğ°Ğ´Ğ¼Ğ¸Ğ½Ğ°
```

### Authenticated (JWT Required)
```
POST /reservations             - Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ±Ñ€Ğ¾Ğ½ÑŒ
GET  /reservations             - ĞœĞ¾Ğ¸ Ğ±Ñ€Ğ¾Ğ½Ğ¸
POST /tickets                  - ĞšÑƒĞ¿Ğ¸Ñ‚ÑŒ Ğ±Ğ¸Ğ»ĞµÑ‚
GET  /tickets                  - ĞœĞ¾Ğ¸ Ğ±Ğ¸Ğ»ĞµÑ‚Ñ‹
POST /checkin/scan             - Ğ¡ĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ QR
GET  /promoters/me/kpi         - KPI Ğ¿Ñ€Ğ¾Ğ¼Ğ¾ÑƒÑ‚ĞµÑ€Ğ°
POST /promoters/leads          - Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ³Ğ¾ÑÑ‚Ñ
```

### Admin Only
```
POST /catalog/admin/events     - Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ğµ
POST /catalog/admin/packages   - Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ¿Ğ°ĞºĞµÑ‚
POST /catalog/admin/seed       - Ğ—Ğ°Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ÑŒ Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ğ¼Ğ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğ¼Ğ¸
GET  /catalog/admin/events     - Ğ’ÑĞµ ÑĞ¾Ğ±Ñ‹Ñ‚Ğ¸Ñ (Ğ½Ğµ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ğµ)
GET  /admin/users              - Ğ’ÑĞµ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ğ¸
GET  /reports/overview         - ĞÑ‚Ñ‡ĞµÑ‚Ñ‹
```

### Webhook (From Telegram)
```
POST /telegram-webhook         - ĞĞ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ñ Ğ¾Ñ‚ Ğ±Ğ¾Ñ‚Ğ°
POST /payments/telegram/callback - ĞŸĞ¾Ğ´Ñ‚Ğ²ĞµÑ€Ğ¶Ğ´ĞµĞ½Ğ¸Ğµ Ğ¿Ğ»Ğ°Ñ‚ĞµĞ¶Ğ°
```

---

## ğŸ’¾ Ğ¡Ñ…ĞµĞ¼Ğ° Ğ‘Ğ°Ğ·Ñ‹ Ğ”Ğ°Ğ½Ğ½Ñ‹Ñ… (Prisma)

### Core Entities

```prisma
model User {
  id            String   @id @default(uuid())
  telegramId    String   @unique
  username      String?
  firstName     String?
  role          Role     @default(GUEST)
  vipLevel      VipLevel?
  referredBy    String?  // ID Ğ¿Ñ€Ğ¾Ğ¼Ğ¾ÑƒÑ‚ĞµÑ€Ğ°
  
  tickets       Ticket[]
  reservations  Reservation[]
  checkIns      CheckIn[]
}

model Event {
  id            String   @id @default(uuid())
  venueId       String
  hallId        String?
  name          String
  description   String?
  date          DateTime
  startTime     DateTime
  endTime       DateTime
  capacity      Int?
  coverCharge   Decimal?
  status        EventStatus @default(ACTIVE)
  
  venue         Venue    @relation(fields: [venueId])
  tickets       Ticket[]
  reservations  Reservation[]
  packages      Package[]
}

model Ticket {
  id            String   @id @default(uuid())
  userId        String
  eventId       String
  packageId     String?
  qrCode        String   @unique
  status        TicketStatus @default(ACTIVE)
  purchasePrice Decimal
  purchasedAt   DateTime @default(now())
  
  user          User     @relation(fields: [userId])
  event         Event    @relation(fields: [eventId])
  checkIn       CheckIn?
}

model CheckIn {
  id            String   @id @default(uuid())
  ticketId      String   @unique
  userId        String
  eventId       String
  checkInTime   DateTime @default(now())
  checkedInBy   String   // Door person ID
  admitted      Boolean  @default(true)
  denyReason    String?
  
  ticket        Ticket   @relation(fields: [ticketId])
}

model PromoterCode {
  id            String   @id @default(uuid())
  promoterId    String
  code          String   @unique
  createdAt     DateTime @default(now())
  expiresAt     DateTime
  used          Boolean  @default(false)
}

enum Role {
  GUEST
  PROMOTER
  DOOR
  MANAGER
  ADMIN
}

enum VipLevel {
  SILVER
  GOLD
  PLATINUM
}
```

---

## ğŸš€ Deployment Architecture (Render)

```
GitHub Repository
   â†“ Auto-deploy on push to main
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Render.com               â”‚
â”‚                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  clubsuite-webapp           â”‚  â”‚
â”‚  â”‚  (Next.js Static + SSR)     â”‚  â”‚
â”‚  â”‚  Port: 3000                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  clubsuite-api              â”‚  â”‚
â”‚  â”‚  (NestJS API)               â”‚  â”‚
â”‚  â”‚  Port: 10000                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  clubsuite-bot              â”‚  â”‚
â”‚  â”‚  (Telegram Webhook Server)  â”‚  â”‚
â”‚  â”‚  Port: 3002                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  clubsuite-postgres         â”‚  â”‚
â”‚  â”‚  (PostgreSQL 16)            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

External:
  Redis Cloud (redis-14432.c14.us-east-1-2.ec2.redns.redis-cloud.com)
```

---

## ğŸ“± Telegram Integration Points

### Bot Commands (Registered)
```javascript
/start      - ĞĞ°Ñ‡Ğ°Ñ‚ÑŒ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñƒ (+ deep links)
/menu       - Ğ“Ğ»Ğ°Ğ²Ğ½Ğ¾Ğµ Ğ¼ĞµĞ½Ñ
/book       - Ğ—Ğ°Ğ±Ñ€Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ ÑÑ‚Ğ¾Ğ»
/events     - ĞœĞµÑ€Ğ¾Ğ¿Ñ€Ğ¸ÑÑ‚Ğ¸Ñ
/my         - ĞœĞ¾Ğ¸ Ğ±Ñ€Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
/promoter   - ĞŸÑ€Ğ¾Ğ¼Ğ¾ÑƒÑ‚ĞµÑ€ Ğ¿Ğ°Ğ½ĞµĞ»ÑŒ
/help       - Ğ¡Ğ¿Ñ€Ğ°Ğ²ĞºĞ°
```

### Menu Button
```javascript
{
  type: 'web_app',
  text: 'ClubSuite',
  web_app: { url: 'https://clubsuite-webapp.onrender.com/app' }
}
```

### Webhooks
```
Bot Webhook: https://clubsuite-bot.onrender.com/bot/SECRET
Health Check: https://clubsuite-bot.onrender.com/health
```

---

## ğŸ§ª Ğ¢ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ğµ Ğ¡Ñ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¸

### Ğ¡Ñ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¹ 1: ĞŸÑ€Ğ¾Ğ¼Ğ¾ÑƒÑ‚ĞµÑ€ ĞŸÑ€Ğ¸Ğ²Ğ¾Ğ´Ğ¸Ñ‚ VIP Ğ“Ğ¾ÑÑ‚Ñ
1. ĞŸÑ€Ğ¾Ğ¼Ğ¾ÑƒÑ‚ĞµÑ€: `/promoter` â†’ Ğ³ĞµĞ½ĞµÑ€Ğ¸Ñ€ÑƒĞµÑ‚ ÑÑÑ‹Ğ»ĞºÑƒ
2. VIP Ğ³Ğ¾ÑÑ‚ÑŒ: ĞºĞ»Ğ¸ĞºĞ°ĞµÑ‚ â†’ Ğ¿Ğ¾ĞºÑƒĞ¿Ğ°ĞµÑ‚ Gold Package ($500)
3. ĞŸÑ€Ğ¾Ğ¼Ğ¾ÑƒÑ‚ĞµÑ€: Ğ²Ğ¸Ğ´Ğ¸Ñ‚ Ğ² stats +$500 revenue, +$75 commission
4. VIP Ğ³Ğ¾ÑÑ‚ÑŒ: Ğ¿Ñ€Ğ¸Ñ…Ğ¾Ğ´Ğ¸Ñ‚ â†’ Door Ğ²Ğ¸Ğ´Ğ¸Ñ‚ â­ GOLD VIP
5. VIP Ğ³Ğ¾ÑÑ‚ÑŒ: Ğ¿Ñ€Ğ¾Ñ…Ğ¾Ğ´Ğ¸Ñ‚ Ğ±ĞµĞ· Ğ¾Ñ‡ĞµÑ€ĞµĞ´Ğ¸
6. Backend: user.vipLevel = 'GOLD' (Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸)

### Ğ¡Ñ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¹ 2: Waitlist â†’ ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ğ—Ğ°Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ
1. Ğ¡Ğ¾Ğ±Ñ‹Ñ‚Ğ¸Ğµ: sold = 200/200 (Ğ¿Ğ¾Ğ»Ğ½Ğ¾ÑÑ‚ÑŒÑ)
2. Ğ“Ğ¾ÑÑ‚ÑŒ Ğ: Join Waitlist â†’ position = 1
3. Ğ“Ğ¾ÑÑ‚ÑŒ Ğ‘: Join Waitlist â†’ position = 2
4. VIP Ğ“Ğ¾ÑÑ‚ÑŒ: Join Waitlist â†’ position = 0 (Ğ¿Ñ€Ğ¸Ğ¾Ñ€Ğ¸Ñ‚ĞµÑ‚!)
5. ĞšÑ‚Ğ¾-Ñ‚Ğ¾ Ğ¾Ñ‚Ğ¼ĞµĞ½ÑĞµÑ‚ Ğ±Ñ€Ğ¾Ğ½ÑŒ â†’ sold = 199
6. Bot â†’ ÑƒĞ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ğµ VIP Ğ³Ğ¾ÑÑ‚Ñ (Ğ¿ĞµÑ€Ğ²Ñ‹Ğ¹ Ğ² Ğ¾Ñ‡ĞµÑ€ĞµĞ´Ğ¸)
7. VIP Ğ³Ğ¾ÑÑ‚ÑŒ: Ğ¿Ğ¾ĞºÑƒĞ¿Ğ°ĞµÑ‚ Ğ·Ğ° 15 Ğ¼Ğ¸Ğ½ÑƒÑ‚
8. sold = 200 again

### Ğ¡Ñ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¹ 3: Door Offline Mode
1. Ğ¡Ğ¾Ğ±Ñ‹Ñ‚Ğ¸Ğµ Ğ½Ğ°Ñ‡Ğ°Ğ»Ğ¾ÑÑŒ, 100 Ğ³Ğ¾ÑÑ‚ĞµĞ¹ ÑƒĞ¶Ğµ Ğ·Ğ°ÑˆĞ»Ğ¸
2. Ğ˜Ğ½Ñ‚ĞµÑ€Ğ½ĞµÑ‚ Ğ¿Ñ€Ğ¾Ğ¿Ğ°Ğ» â†’ ğŸ“¡ OFFLINE
3. Door: Ğ¿Ñ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶Ğ°ĞµÑ‚ ÑĞºĞ°Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ (Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°ĞµÑ‚ Ñ ĞºÑÑˆĞµĞ¼)
4. 50 Ğ³Ğ¾ÑÑ‚ĞµĞ¹ Ğ¿Ñ€Ğ¾ÑˆĞ»Ğ¸ â†’ check-ins Ğ² Ğ¾Ñ‡ĞµÑ€ĞµĞ´Ğ¸
5. Ğ˜Ğ½Ñ‚ĞµÑ€Ğ½ĞµÑ‚ Ğ¿Ğ¾ÑĞ²Ğ¸Ğ»ÑÑ â†’ ğŸŸ¢ ONLINE
6. Door: "Sync Queue" â†’ Ğ²ÑĞµ 50 ÑĞ¸Ğ½Ñ…Ñ€Ğ¾Ğ½Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ñ‹
7. Backend: ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸ĞºĞ° ĞºĞ¾Ñ€Ñ€ĞµĞºÑ‚Ğ½Ğ°

---

## ğŸ“ˆ ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ¸ Ğ¸ KPI

### ĞĞ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¾Ğ½Ğ½Ñ‹Ğµ (Real-time)
- **Ğ’Ñ…Ğ¾Ğ´Ñ‹ Ğ¿Ğ¾ Ñ‡Ğ°ÑĞ°Ğ¼** - Ğ³Ñ€Ğ°Ñ„Ğ¸ĞºĞ¸ Ğ¿Ğ¸ĞºĞ¾Ğ²
- **Ğ¢ĞµĞºÑƒÑ‰Ğ°Ñ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ°** - X/capacity
- **No-show rate** - % Ğ½Ğµ Ğ¿Ñ€Ğ¸ÑˆĞµĞ´ÑˆĞ¸Ñ…
- **Ğ¡Ñ€ĞµĞ´Ğ½ÑÑ Ğ¾Ñ‡ĞµÑ€ĞµĞ´ÑŒ** - Ğ²Ñ€ĞµĞ¼Ñ Ğ¿Ñ€Ğ¾Ñ…Ğ¾Ğ´Ğ°

### ĞŸÑ€Ğ¾Ğ¼Ğ¾ÑƒÑ‚ĞµÑ€ÑĞºĞ¸Ğµ
- **Conversion rate** - invited â†’ confirmed
- **Attendance rate** - confirmed â†’ attended
- **Revenue per lead** - total_revenue / invited
- **Commission earned** - ÑÑƒĞ¼Ğ¼Ğ° Ğ²Ñ‹Ğ¿Ğ»Ğ°Ñ‚

### Ğ¤Ğ¸Ğ½Ğ°Ğ½ÑĞ¾Ğ²Ñ‹Ğµ
- **Total revenue** - Ğ¾Ğ±Ñ‰Ğ°Ñ Ğ²Ñ‹Ñ€ÑƒÑ‡ĞºĞ°
- **By channel** - Telegram vs Direct vs Promoter
- **Average check** - ÑÑ€ĞµĞ´Ğ½Ğ¸Ğ¹ Ñ‡ĞµĞº
- **VIP contribution** - % Ğ¾Ñ‚ VIP Ğ³Ğ¾ÑÑ‚ĞµĞ¹

### ĞœĞ°Ñ€ĞºĞµÑ‚Ğ¸Ğ½Ğ³Ğ¾Ğ²Ñ‹Ğµ
- **Repeat rate** - % Ğ¿Ğ¾Ğ²Ñ‚Ğ¾Ñ€Ğ½Ñ‹Ñ… Ğ²Ğ¸Ğ·Ğ¸Ñ‚Ğ¾Ğ²
- **Time to return** - ÑÑ€ĞµĞ´Ğ½Ğ¸Ğ¹ Ğ¸Ğ½Ñ‚ĞµÑ€Ğ²Ğ°Ğ» Ğ¼ĞµĞ¶Ğ´Ñƒ Ğ²Ğ¸Ğ·Ğ¸Ñ‚Ğ°Ğ¼Ğ¸
- **Campaign ROI** - Ğ²Ñ‹Ñ€ÑƒÑ‡ĞºĞ° / Ğ·Ğ°Ñ‚Ñ€Ğ°Ñ‚Ñ‹ Ğ½Ğ° Ñ€ĞµĞºĞ»Ğ°Ğ¼Ñƒ

---

**ĞŸĞ¾ÑĞ»ĞµĞ´Ğ½ĞµĞµ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ**: 28.10.2025
**Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ**: Production Ready âœ…
